# 1 . ìœ ì € ë ˆë²¨ë¡œ ë°ì´í„° ì´ê´€

ì†Œìœ ì: ì˜ë‹ˆ

<aside>
ğŸ’¡ ìˆœì„œ

1. ë‚˜ì˜ ì˜ë¬¸Â ì´ë¦„Â DBÂ ( shm DB )ë¥¼ ì˜¬ë ¤ì„œÂ kingÂ ì´ë¼ëŠ”Â ìœ ì ¸ë¥¼Â ìƒì„±
2. orcl DBÂ ìª½ì˜Â scottÂ ê³„ì •ì˜Â ëª¨ë“ Â í…Œì´ë¸”ë“¤ì„Â shm DBì˜Â kingÂ ìœ ì ¸ì— ì „ë¶€Â ì´ê´€
</aside>

1. shm DBì— king ìœ ì € ìƒì„±
    
    ```sql
    create user king
    	identified by king;
    
    grant resource, connect to king;
    ```
    


1. orcl DBì˜ scottê³„ì •ì—ì„œ USER LEVELë¡œ ëª¨ë“  í…Œì´ë¸” ë°ì´í„° exportí•˜ê¸°
    
    ```sql
    [orcl:~]$ exp scott/tiger owner=scott file=scott.dmp
    ```
    
    
    ((ì´í•˜ìƒëµ))
    

1. shm DBì— ë°ì´í„° iportí•˜ê¸° ì „ì— ê¸°ë³¸ í…Œì´ë¸” ìŠ¤í˜ì´ìŠ¤ë¥¼ í™•ì¸í•˜ê³ , ê¸°ë³¸ í…Œì´ë¸” ìŠ¤í˜ì´ìŠ¤ì— ê³µê°„ì´ ìˆëŠ”ì§€ í™•ì¸
    - ê¸°ë³¸ í…Œì´ë¸” ìŠ¤í˜ì´ìŠ¤ í™•ì¸í•˜ê¸°
        
        ```sql
        shm SYS > @dbp
        
        PROPERTY_NAME                       PROPERTY_VALUE
        ----------------------------------- -------------------------
        DICT.BASE                           2
        DEFAULT_TEMP_TABLESPACE             TEMP
        DEFAULT_PERMANENT_TABLESPACE        USERS
        DEFAULT_EDITION                     ORA$BASE
        Flashback Timestamp TimeZone        GMT
        TDE_MASTER_KEY_ID
        DST_UPGRADE_STATE                   NONE
        DST_PRIMARY_TT_VERSION              11
        DST_SECONDARY_TT_VERSION            0
        DEFAULT_TBS_TYPE                    SMALLFILE
        NLS_LANGUAGE                        AMERICAN
        
        PROPERTY_NAME                       PROPERTY_VALUE
        ----------------------------------- -------------------------
        NLS_TERRITORY                       AMERICA
        NLS_CURRENCY                        $
        NLS_ISO_CURRENCY                    AMERICA
        NLS_NUMERIC_CHARACTERS              .,
        NLS_CHARACTERSET                    KO16MSWIN949
        NLS_CALENDAR                        GREGORIAN
        NLS_DATE_FORMAT                     DD-MON-RR
        NLS_DATE_LANGUAGE                   AMERICAN
        NLS_SORT                            BINARY
        NLS_TIME_FORMAT                     HH.MI.SSXFF AM
        NLS_TIMESTAMP_FORMAT                DD-MON-RR HH.MI.SSXFF AM
        
        PROPERTY_NAME                       PROPERTY_VALUE
        ----------------------------------- -------------------------
        NLS_TIME_TZ_FORMAT                  HH.MI.SSXFF AM TZR
        NLS_TIMESTAMP_TZ_FORMAT             DD-MON-RR HH.MI.SSXFF AM
                                            TZR
        
        NLS_DUAL_CURRENCY                   $
        NLS_COMP                            BINARY
        NLS_LENGTH_SEMANTICS                BYTE
        NLS_NCHAR_CONV_EXCP                 FALSE
        NLS_NCHAR_CHARACTERSET              AL16UTF16
        NLS_RDBMS_VERSION                   11.2.0.1.0
        GLOBAL_DB_NAME                      SHM
        
        PROPERTY_NAME                       PROPERTY_VALUE
        ----------------------------------- -------------------------
        EXPORT_VIEWS_VERSION                8
        WORKLOAD_CAPTURE_MODE
        WORKLOAD_REPLAY_MODE
        NO_USERID_VERIFIER_SALT             820EA1118701F6539A50393BB
                                            68B7AD0
        
        DBTIMEZONE                          00:00
        
        36 rows selected.
        ```
        

        
    - í…Œì´ë¸” ìŠ¤í˜ì´ìŠ¤ì˜ ê³µê°„ í™•ì¸í•˜ê¸°
        
        ```sql
        shm SYS > @space
        
        Tablespace Total Space (MB) Used Space (MB) Free Space (MB)
        ---------- ---------------- --------------- ---------------
        SYSAUX                  510          473.13           36.88
        UNDOTBS1                 85           15.31           69.69
        TEMP                     29              29              29
        USERS                     5            4.06             .94
        SYSTEM                  680          675.69            4.31
        EXAMPLE                 100           78.75           21.25
        ```
        

        
    - USERS í…Œì´ë¸” ìŠ¤í˜ì´ìŠ¤ì˜ ê²½ë¡œ í™•ì¸í•˜ê¸°
        
        ```sql
        shm SYS > @tablespace
        
        TABLESPACE STATUS    FILE_NAME
        ---------- --------- -------------------------------------------------------
        USERS      AVAILABLE /u01/app/oracle/oradata/shm/users01.dbf
        UNDOTBS1   AVAILABLE /u01/app/oracle/oradata/shm/undotbs01.dbf
        SYSAUX     AVAILABLE /u01/app/oracle/oradata/shm/sysaux01.dbf
        SYSTEM     AVAILABLE /u01/app/oracle/oradata/shm/system01.dbf
        EXAMPLE    AVAILABLE /u01/app/oracle/oradata/shm/example01.dbf
        ```
        

        
    - USERS í…Œì´ë¸” ìŠ¤í˜ì´ìŠ¤ì— ê³µê°„ ì¶”ê°€í•˜ê¸°
        
        ```sql
        shm SYS >
        alter tablespace users
        	add datafile '/u01/app/oracle/oradata/shm/users02.dbf' size 300m;
        ```
        

        

1. shm DBì˜ king ìœ ì €ì— ë°ì´í„° import í•˜ê¸°
    
    ```sql
    [shm:~]$ imp system/oracle_4U file=scott.dmp fromuser=scott touser=king
    ```
    


---

### ë¹„êµí•´ë³´ê¸°

1. orcl DBì˜ SCOTTê³„ì •ì— ì ‘ì†í•´ì„œ ìœ ì € ë ˆë²¨ë¡œ í†µê³„ì •ë³´ ìˆ˜ì§‘
    
    ```sql
    orcl SCOTT > 
    
    exec dbms_stats.gather_schema_stats('SCOTT');
    ```
    

2. USER_TABLESë¥¼ ì¡°íšŒí•´ì„œ í…Œì´ë¸” ì´ë¦„ê³¼ NUM_ROWSë¥¼ ì¡°íšŒ
    
    ```sql
    select table_name, num_rows
    	from user_tables;
    ```
    

3. shm DBì˜ kingê³„ì •ìœ¼ë¡œ ì ‘ì†í•´ì„œ ìœ ì € ë ˆë²¨ë¡œ í†µê³„ ì •ë³´ë¥¼ ìˆ˜ì§‘
    
    ```sql
    exec dbms_stats.gather_schema_stats('KING');
    ```
    

    
4. USER_TABLESë¥¼ ì¡°íšŒí•´ì„œ í…Œì´ë¸” ì´ë¦„ê³¼ NUM_ROWSë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
    
    ```sql
    select table_name, num_rows
    	from user_tables;
    ```
    

    
    ì´ì œ ì´ë¥¼ ë¹„êµí•˜ê¸° ìœ„í•œ ë°©ë²•ì€ db linkë¥¼ ìƒì„±í•´ì„œ ë¹„êµí•˜ë©´ ëœë‹¤.
    

1. PROD DB SYSì—ì„œ SCOTT3ìœ ì €ì— create public database link ê¶Œí•œê³¼ drop public database link ê¶Œí•œì„ ì¤€ë‹¤.
    
    ```sql
    shm SYS > grant create public database link, drop public database link to king;
    ```
    

2. scott3 ì—ì„œ dbë§í¬ë¥¼ ìƒì„±í•˜ëŠ”ë°, orcl DBì˜ SCOTTì˜ í…Œì´ë¸”ì„ ì—‘ì„¸ìŠ¤ í•  ìˆ˜ ìˆëŠ” DBë§í¬ ìƒì„±
    
    ```sql
    shm SYS >
    create public database link orcl_scott_link2
    	connect to scott
    	identified by tiger
    	using '192.168.19.51:1521/orcl.us.oracle.com';
    ```
    

    
    - ì˜ ì—°ê²° ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê¸°
        
        ```sql
        shm KING > select count(*) from emp@orcl_scott_link2;
        
          COUNT(*)
        ----------
                14
        ```
        
        

1. ë¹„êµí•´ë³´ê¸°
    
    ```sql
    < orclì— ìˆëŠ”ë° ë‚˜í•œí…Œ ì—†ëŠ”ê±° >
    select table_name, num_rows
    	from user_tables@orcl_scott_link2
    minus
    select table_name, num_rows
    	from user_tables;
    ```
    
    ```sql
    TABLE_NAME                                                     NUM_ROWS
    ------------------------------------------------------------ ----------
    BONUS                                                                 0
    ```
    

    
    â‡’ ëª» ë„˜ì–´ì˜¨ 1ê°œëŠ” ë”°ë¡œ ë„˜ê²¨ì¤˜ì•¼í•¨
    
2. ì˜¤ë¼í´ EXPORT ì‹œ ë°ì´í„° ì—†ëŠ” í…Œì´ë¸”ê¹Œì§€ ì´ê´€í•˜ëŠ” ë°©ë²•
    - ì˜¤ë¼í´ 11G ë¶€í„°ëŠ” ê¸°ë³¸ ì„¤ì •ì´ ë°ì´í„° ì—†ì„ ë•ŒëŠ” EXPORT ì•ˆë¨ ì•„ë˜ ë‚´ìš©ìœ¼ë¡œ ì„¤ì • ë³€ê²½ í•„ìš”
        
        ```sql
        ALTER TABLE <empty table name> ALLOCATE EXTENT;
        
        ex ) ALTER TABLE bonus ALLOCATE EXTENT;
        ```
        


1. orcl DBì˜ SCOTTê³„ì •ì˜ bonus í…Œì´ë¸”ì„ TABLE LEVELë¡œ ë°ì´í„° ì´ê´€í•˜ê¸°
    
    ```sql
    [orcl:~]$
    exp scott/tiger tables=bonus file=bonus.dmp 
    ```
    
    ```sql
    [orcl:~]$ exp scott/tiger tables=bonus file=bonus.dmp
    
    Export: Release 11.2.0.1.0 - Production on Wed Feb 21 17:19:45 2024
    
    Copyright (c) 1982, 2009, Oracle and/or its affiliates.  All rights reserved.
    
    Connected to: Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - Production
    With the Partitioning, Automatic Storage Management, OLAP, Data Mining
    and Real Application Testing options
    Export done in US7ASCII character set and AL16UTF16 NCHAR character set
    server uses AL32UTF8 character set (possible charset conversion)
    
    About to export specified tables via Conventional Path ...
    . . exporting table                          BONUS          0 rows exported
    EXP-00091: Exporting questionable statistics.
    Export terminated successfully with warnings.
    ```
    

    

1. shm DBì˜ king ê³„ì •ì— orcl DBì˜ SCOTTê³„ì •ì˜ bonus í…Œì´ë¸” ë°ì´í„° ì´ê´€
    
    ```sql
    imp king/king tables=bonus file=bonus.dmp fromuser=scott touser=king
    ```
    

2. DBA ê¶Œí•œì´ ì—†ì–´ì„œ IMPORTê°€ ì•ˆë˜ëŠ” ì—ëŸ¬ ë°œìƒ
    
    `IMP-00013: only a DBA can import a file exported by another DBA`
    
    (ì™œ? orcl DBì˜ SCOTTê³„ì •ì´  dbaê¶Œí•œì´ ìˆì„ ë•Œ ë§Œë“¤ì–´ì§„ í…Œì´ë¸”ë“¤ì„ importë°›ìœ¼ë ¤ë©´ importë°›ìœ¼ë ¤ëŠ” ê³„ì •ë„ dba ê¶Œí•œì´ ìˆì–´ì•¼í•¨)
    
    ```sql
    shm SYS > grant dba to king;
    
    Grant succeeded.
    ```
    

    

1. bonus í…Œì´ë¸”ì„ ë‹¤ì‹œ ë°ì´í„° import 
    
    ```sql
    [shm:~]$ imp king/king tables=bonus file=bonus.dmp fromuser=scott touser=king
    
    Import: Release 11.2.0.1.0 - Production on Wed Feb 21 17:36:52 2024
    
    Copyright (c) 1982, 2009, Oracle and/or its affiliates.  All rights reserved.
    
    Connected to: Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - Production
    With the Partitioning, OLAP, Data Mining and Real Application Testing options
    
    Export file created by EXPORT:V11.02.00 via conventional path
    
    Warning: the objects were exported by SCOTT, not by you
    
    import done in US7ASCII character set and AL16UTF16 NCHAR character set
    import server uses KO16MSWIN949 character set (possible charset conversion)
    . importing SCOTT's objects into KING
    . . importing table                        "BONUS"          0 rows imported
    Import terminated successfully without warnings.
    ```
    

    

1. DB LINKë¥¼ ì´ìš©í•´ì„œ ë‹¤ì‹œ ë¹„êµí•´ë³´ê¸°
    
    ```sql
    shm KING >
    select table_name, num_rows
    	from user_tables@orcl_scott_link2
    minus
    select table_name, num_rows
    	from user_tables;
    ```
